{% extends 'base.html' %}
{% block content %}

<div class="page">

    <div class="user">
        <h1>{{ current_user.username }}</h1>

        <div id="userContent">

            <p>Email: {{ current_user.email }}</p>

        </div>
        <button id="deleteUserBtn" data-username="{{ current_user.username }}">Delete Account</button>

    </div>

</div>

<script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
<script>
    document.getElementById('deleteUserBtn').addEventListener('click', function() {
        const username = this.dataset.username;
        if (!username) {
            console.error("Username is not provided.");
            return;
        }

        if (!confirm('Are you sure you want to delete this account?')) {
            return;
        }

        const url = `/users/${username}/delete`; 

        axios.post(url)
        .then(response => {
            console.log(response.data.message);
            window.location.href = '/flashdelete';
        })
        .catch(error => {
            console.error('Error during the delete operation:', error);
        });
    });
</script>

{% endblock %}

{% block head %}
<link rel="stylesheet" href="/static/users/dashboard.css">
{% endblock %}
